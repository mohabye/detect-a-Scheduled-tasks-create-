# detect-a-Scheduled-tasks-create-
This code sets up an event filter and query to monitor the creation of new scheduled tasks in the Microsoft Windows Task Scheduler. The code uses the Eventing.Reader namespace in the .NET Framework to create an EventLogQuery object that specifies the query criteria for the events to be monitored. The event filter is defined using an XML query language and contains a single query with the following criteria:

Provider name: Microsoft-Windows-TaskScheduler
Event ID: 140
This means that the query will only return events with an ID of 140 that were generated by the Microsoft-Windows-TaskScheduler provider.

After the filter and query are set up, the code creates an EventLogWatcher object that uses the query to monitor events in the Microsoft-Windows-TaskScheduler log. The code then starts the watcher and enters a loop that waits for events to be generated. When an event with an ID of 140 is detected, the code extracts the name of the newly created task from the event properties and generates an alert message. The message is then displayed on the console using the Write-Host cmdlet, and an email alert is sent to the specified administrator using the Send-MailMessage cmdlet. The loop then continues to wait for new events.

Overall, this code demonstrates how to use .NET Framework classes and PowerShell cmdlets to monitor and respond to specific events in Windows. It could be used as part of a larger system monitoring or security monitoring solution.

Note that the script should be run with administrative privileges to access the event log .
